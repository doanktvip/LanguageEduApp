{% extends 'layout/base.html' %}

{% block title %}Đổi mật khẩu{% endblock %}

{% block card_header %}
<div class="p-3">
    <i class="bi bi-shield-lock-fill me-2"></i>Đổi mật khẩu
</div>
{% endblock %}

{% block card_body %}
<style>
    #old_password {
        background-image: none !important;
    }
</style>
{% if err_msg %}
<div class="alert alert-danger d-flex align-items-center mb-4 border-0 shadow-sm" role="alert">
    <i class="bi bi-exclamation-triangle-fill me-2 fs-5"></i>
    <div>{{ err_msg }}</div>
</div>
{% endif %}

<div class="row justify-content-center">
    <div class="col-md-10 col-lg-8">
        <form method="post" class="was-validated">

            <p class="text-muted small fst-italic mb-4 text-center">
                Vui lòng nhập mật khẩu cũ để xác thực trước khi thay đổi.
            </p>

            <div class="form-floating mb-3 position-relative">
                <input type="password" class="form-control" id="old_password" name="old_password"
                       placeholder="Mật khẩu cũ" required
                       oninput="this.value = this.value.replace(/\s/g, '')">
                <label for="old_password">Mật khẩu cũ</label>

                <span class="position-absolute top-50 end-0 translate-middle-y me-3 text-secondary"
                      id="toggle_old_password" style="cursor: pointer; z-index: 10;">
                    <i class="bi bi-eye-slash" id="icon_old_password"></i>
                </span>
            </div>

            <hr class="text-secondary opacity-25 my-4">

            <div class="form-floating mb-3 position-relative">
                <input type="password" class="form-control" id="new_password" name="new_password"
                       placeholder="Mật khẩu mới" required minlength="6" maxlength="20">
                <label for="new_password">Mật khẩu mới</label>
                <div class="invalid-feedback">
                    Mật khẩu phải từ 6 đến 20 ký tự.
                </div>
            </div>


            <div class="form-floating mb-3 position-relative">
                <input type="password" class="form-control" id="re_enter_password" name="re_enter_password"
                       placeholder="Nhập lại" required minlength="6" maxlength="20">
                <label for="re_enter_password">Xác nhận mật khẩu</label>
                <div class="invalid-feedback">
                    Vui lòng nhập lại mật khẩu khớp với bên trên.
                </div>
            </div>


            <div class="d-flex justify-content-end gap-2">
                <a href="/" class="btn btn-light border text-secondary">Hủy bỏ</a>
                <button class="btn btn-primary px-4 fw-bold shadow-sm">
                    <i class="bi bi-check-circle-fill me-2"></i>Lưu thay đổi
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block javascript %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        setupPasswordToggle("toggle_old_password", "old_password", "icon_old_password");
    });
</script>
{% endblock %}