{% extends 'admin/master.html' %}
{% block card_header %}
<div class="row p-3 d-flex justify-content-between align-items-center">
    <div class="col-md-6 col-12 mb-3 mb-md-0">
        <span class="fw-bold text-uppercase"><i class="bi bi-speedometer2 me-2"></i>Quản lý hệ thống</span>
    </div>
    <div class="col-md-6 col-12 d-flex justify-content-md-end justify-content-between align-items-center">
        <div class="text-end">
            <small class="text-muted d-block" style="font-size: 0.7rem;">Thời gian hiện tại</small>
            <span id="live-time" class="fw-bold text-dark font-monospace">--:--:--</span>
        </div>
    </div>
</div>
{% endblock %}
{% block body %}
<div class="container-fluid p-0">

    <div class="row g-4 row-cols-1 row-cols-md-2 row-cols-xl-4">

        <div class="col">
            <a href="{{ url_for('hoadon.index_view', flt0_0='DA_THANH_TOAN') }}"
               class="stats-card-link">
                <div class="card bg-primary text-white h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Doanh Thu Thực</div>
                            <div class="card-value">{{ tong_doanh_thu }}</div>
                            <small class="opacity-75"><i class="bi bi-check-circle"></i> Đã thanh toán</small>
                        </div>
                        <i class="bi bi-currency-dollar card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('hoadon.index_view', flt0_0='CHUA_THANH_TOAN') }}"
               class="stats-card-link">
                <div class="card bg-danger text-white h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Hóa Đơn Treo</div>
                            <div class="card-value">{{ so_hoa_don_no }}</div>
                            <small class="opacity-75"><i class="bi bi-exclamation-triangle"></i> Chưa thanh toán</small>
                        </div>
                        <i class="bi bi-receipt-cutoff card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('khoahoc.index_view', flt0_0='DANG_TUYEN_SINH') }}"
               class="stats-card-link">
                <div class="card bg-warning text-dark h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Đang Tuyển Sinh</div>
                            <div class="card-value">{{ khoa_dang_tuyen }}</div>
                            <small class="opacity-75"><i class="bi bi-megaphone"></i> Khóa sắp mở</small>
                        </div>
                        <i class="bi bi-bullseye card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('khoahoc.index_view', flt0_0='DUNG_TUYEN_SINH') }}"
               class="stats-card-link">
                <div class="card bg-secondary text-white h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Lớp Đang Dạy</div>
                            <div class="card-value">{{ lop_dang_hoc }}</div>
                            <small class="opacity-75"><i class="bi bi-journal-bookmark"></i> Đang hoạt động</small>
                        </div>
                        <i class="bi bi-easel2 card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('hocvien.index_view') }}" class="stats-card-link">
                <div class="card bg-success text-white h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Tổng Học Viên</div>
                            <div class="card-value">{{ so_hoc_vien }}</div>
                            <small class="opacity-75"><i class="bi bi-people"></i> Sinh viên</small>
                        </div>
                        <i class="bi bi-backpack2 card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('giaovien.index_view') }}" class="stats-card-link">
                <div class="card bg-info text-white h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Giáo Viên</div>
                            <div class="card-value">{{ so_giao_vien }}</div>
                            <small class="opacity-75"><i class="bi bi-person-video3"></i> Giảng dạy</small>
                        </div>
                        <i class="bi bi-mortarboard card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('nhanvien.index_view') }}" class="stats-card-link">
                <div class="card bg-dark text-white h-100 border-0 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text">Nhân Sự</div>
                            <div class="card-value">{{ so_nhan_vien }}</div>
                            <small class="opacity-75"><i class="bi bi-headset"></i> Tư vấn & Admin</small>
                        </div>
                        <i class="bi bi-person-badge card-icon-bg"></i>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url_for('phonghoc.index_view') }}" class="stats-card-link">
                <div class="card border-secondary text-secondary bg-white h-100 shadow-sm rounded-3">
                    <div class="card-body d-flex justify-content-between align-items-center">
                        <div>
                            <div class="card-title-text text-dark">Phòng Học</div>
                            <div class="card-value text-dark">{{ so_phong_hoc }}</div>
                            <small class="text-muted"><i class="bi bi-geo-alt"></i> Cơ sở vật chất</small>
                        </div>
                        <i class="bi bi-building card-icon-bg text-secondary"></i>
                    </div>
                </div>
            </a>
        </div>

    </div>
</div>
{% endblock %}
{% block javascript %}
<script>
    function updateClock() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('vi-VN', { hour12: false });
        document.getElementById('live-time').innerText = timeString;
    }
    setInterval(updateClock, 1000);
    updateClock();
</script>
{% endblock %}